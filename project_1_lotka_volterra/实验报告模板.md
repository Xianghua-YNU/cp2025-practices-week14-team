# 项目1实验报告：Lotka-Volterra捕食者-猎物模型

**学生姓名：** [邵星宇]  
**学号：** [20231050032]  
**完成日期：** [2025.5.28]  
**实验时间：** [2025.5.28]

---

## 1. 实验目的

本实验旨在通过数值方法求解Lotka-Volterra捕食者-猎物模型，掌握以下内容：

- 理解生物种群动力学的数学建模方法
- 学习将高阶常微分方程组转换为一阶方程组的标准形式
- 掌握多种数值方法求解常微分方程组（欧拉法、改进欧拉法、4阶龙格-库塔法）
- 比较不同数值方法的精度和稳定性
- 分析生态系统中捕食者与猎物的相互作用规律

## 2. 理论背景

### 2.1 Lotka-Volterra方程组

请简要描述Lotka-Volterra方程组的数学形式和各参数的生物学意义：

```
\begin{cases}
\frac{dN}{dt} = rN - aNP \\
\frac{dP}{dt} = baNP - mP
\end{cases}
N(t)：猎物种群数量（如兔子）
P(t)：捕食者种群数量（如狐狸）
t：时间
r	猎物内禀增长率	无捕食者时猎物的自然增殖速率（出生率-死亡率）	[时间⁻¹]
a	捕食效率系数	单个捕食者单位时间内捕食猎物的成功率	[猎物⁻¹·时间⁻¹]
b	转化效率系数	捕食者将猎物生物量转化为自身繁殖的效率（能量转化率）	[捕食者·猎物⁻¹]
m	捕食者死亡率	无猎物时捕食者的自然死亡率	[时间⁻¹]
```

### 2.2 数值方法原理

请简要说明您实现的三种数值方法的基本原理：

**欧拉法：**
```
离散化时间
将连续时间区间 $[t_0, t_f]$ 分割为 $N$ 个等距步长：
局部线性近似
在每一步 $t_n$，假设解在短时间 $\Delta t$ 内按当前导数值线性变化：
迭代推进
从初始条件 $\mathbf{y}(t_0) = \mathbf{y}_0$ 出发，逐步计算后续时间点的近似解。
对于方程 $\frac{dy}{dt} = f(t, y)$，显式欧拉法的递推公式为
y_n+1=y_n+f(t_n,y_n)·δt
对于方程组 $\frac{d\mathbf{y}}{dt} = \mathbf{f}(t, \mathbf{y})$，其中 $\mathbf{y} = [y_1, y_2, ..., y_m]^T$，公式用为向量形式：每个分量独立更新

```

**改进欧拉法：**
```
改进欧拉法通过引入预测-校正步骤，将精度提升至二阶。这使得在相同步长h下，解的精度显著提高；或在相同精度要求下，允许使用更大步长以减少计算量。
改进欧拉法通过校正步骤的斜率平均，扩展了稳定性区域，允许在更大步长下保持稳定，尤其对中等刚性问题适应性更强。
```

**4阶龙格-库塔法：**
```
局部阶段误差为4阶，明显小于改进欧拉法。这就导致其可以使用更长的步长来精确计算，减少计算次数，计算时间与误差累积。若解足够光滑，RK4能充分利用高阶精度优势，逼近解析解。通过多阶段斜率加权平均，RK4能更好地捕捉解的曲率变化，适用于高度非线性的微分方程
```

## 3. 实验方法与实现

### 3.1 参数设置

根据题目要求，本实验使用以下参数：

- 模型参数：α = 1.0, β = 0.5, γ = 0.5, δ = 2.0
- 初始条件：x₀ = 2.0, y₀ = 2.0
- 时间范围：t ∈ [0, 30]
- 时间步长：dt = 0.01

### 3.2 核心算法实现

请在此处粘贴您实现的核心函数代码片段（选择最重要的1-2个函数）：

```python
def lotka_volterra_system(state: np.ndarray, t: float, alpha: float, beta: float, 
                          gamma: float, delta: float) -> np.ndarray:
    x, y = state
    # 修正dxdt
    dxdt = alpha * x - beta * x * y  # 当x=y=1, alpha=1, beta=0.5时，dxdt = 1 - 0.5 = 0.5
    dydt = gamma * x * y - delta * y  # 当x=y=1, gamma=0.5, delta=2时，dydt = 0.5 - 2 = -1.5
    return np.array([dxdt, dydt])
```

```python
def solve_lotka_volterra(alpha: float, beta: float, gamma: float, delta: float,
                        x0: float, y0: float, t_span: Tuple[float, float], 
                        dt: float) -> Tuple[np.ndarray, np.ndarray, np.ndarray]:
    y0_vec = np.array([x0, y0])
    t, solution = runge_kutta_4(lotka_volterra_system, y0_vec, t_span, dt, 
                               alpha, beta, gamma, delta)
    
    x = solution[:, 0]
    y = solution[:, 1]
    
    return t, x, y
```

### 3.3 实现过程中遇到的问题

请描述您在实现过程中遇到的主要问题及解决方法：

```
相空间轨迹闭合性异常
理想情况下，Lotka-Volterra模型的相空间轨迹应为闭合曲线。若数值方法精度不足（如欧拉法），轨迹可能发散或无法闭合。

解决方案：使用更高阶方法（如RK4）或减小步长。

能量守恒验证失败
守恒量 H = gamma * x + beta * y - delta * np.log(x) - alpha * np.log(y) 的计算需确保参数与公式一致，若 H 不守恒，可能暴露数值误差或公式错误。
```

## 4. 实验结果

### 4.1 基本求解结果

请在此处粘贴使用4阶龙格-库塔法求解得到的种群动力学图：

```
![prey and predater](https://github.com/user-attachments/assets/fd44bab1-dc95-44f5-94bd-ae0f1d756c7a)


图4.1: Lotka-Volterra种群动力学
左图：种群数量随时间变化；右图：相空间轨迹
```

**观察结果描述：**
```
猎物与猎手之间的数量关系随时间变化是此消彼长，猎物的相位会比猎手的延迟约1/4个周期。其相空间轨迹为一闭合曲线，表示其稳定的周期性循环特征。
```

### 4.2 数值方法比较

请在此处粘贴三种数值方法的比较图：

```
![prey and predater2](https://github.com/user-attachments/assets/52946695-fe93-4a1d-a8ca-e40e48778426)


图4.2: 三种数值方法比较
上排：时间序列比较；下排：相空间比较
```

**比较结果分析：**

| 方法 | 计算精度 | 计算效率 | 稳定性 | 守恒量误差 |
|------|----------|----------|--------|------------|
| 欧拉法 | 低，一阶 | 低 | 低 | 低 |
| 改进欧拉法 | 较高，二阶 | 较高 | 较低 | 较低 |
| 4阶RK法 | 最高，四阶| 最高 | 最高 | 最低 |

### 4.3 参数影响分析

请在此处粘贴不同初始条件下的结果图：

```
![prey and predater 3](https://github.com/user-attachments/assets/9a3963bc-18a2-422a-aec3-7e4a171d7531)


图4.3: 不同初始条件的影响
```

**参数敏感性分析：**
```
改变猎物与猎手的初始值并不会改变二者数量震荡的周期，只会改变二者震荡的振幅，在相空间也可以看出。不过经过的时间越久，系统守恒量的误差就会越来越大，而能量守恒误差的变化也是一个周期性的震荡。
```

## 5. 结果分析与讨论

### 5.1 生物学意义分析

请从生物学角度分析实验结果：

**种群动力学特征：**
```
此消彼长的震荡规律，猎物多则捕食者增长，然后猎物变少，捕食者下降，然后猎物又增多，捕食者又跟着变多，周期往复，循环更替。
```

**相互作用机制：**
```
在相空间（x-y平面）中，轨迹为闭合曲线（椭圆或环形），相位差表现为轨迹的逆时针旋转方向（猎物先增后减，捕食者跟随）
```

**生态平衡：**
```
猎物数量范围: [2.000, 7.026]
捕食者数量范围: [0.715, 4.307]
平均猎物数量: 3.942
平均捕食者数量: 1.933
估计周期: 4.660
```

### 5.2 数值方法评估

**精度比较：**
```
欧拉法运用最基础的一阶线性逼近，精度为一阶，精度较低，但是作为最基本的ODE求解方法固然重要。改进欧拉法则将精度提升到2阶，而龙格库塔四阶算法可以精确到四阶,所以这三种方法在相同精度的计算下，越往后面的方法所需的步长约长，在相同步长的计算下，越往后的计算精度越高。
```

**计算效率：**
```
欧拉法：每步仅需计算1次导数，计算量最小。

改进欧拉法：每步需2次导数计算（预测步 + 校正步）。

RK4：每步需4次导数计算
故而看精度需求不高，可采用欧拉法，省时省力，若需要很高的精度则RK4不可避免。
```

**适用性分析：**
```
优先RK4：高精度需求下效率与稳定性显著优于低阶方法。

慎用欧拉法：仅适用于误差不敏感场景或教学演示。

改进欧拉法：资源有限时的折中选择。
```

## 6. 思考题

请回答以下思考题：

### 6.1 周期性分析
**问题：** 为什么Lotka-Volterra系统会表现出周期性行为？这种周期性在现实生态系统中是否存在？
**回答：**
```
Lotka-Volterra模型是完美闭合轨迹，持续振荡，而现实生态系统具有不规则周期，受环境扰动影响。Lotka-Volterra模型中性稳定（无阻尼振荡），而实际中可能趋向稳定焦点（资源限制）。理想模型忽略环境噪声、人类活动等,现实生态系统具有复杂多变的影响因素。不过大致的周期性也可以从现实中大致看出来，为理想化的模型假设提供实质性证据。
```



**实验报告完成情况自评：**

- [ 1] 完成了所有必需的函数实现
- [ 1] 通过了所有测试用例
- [ 1] 生成了所有要求的图表
- [ 1] 完成了结果分析和讨论
- [ 1] 回答了所有思考题

**总体评价：** 试验完成情况完整，结果清晰，阐述明了，分析得当。实验架构清晰，从理论建模到数值验证，层层递进，完美融合数学、生态学与计算科学。充分利用NumPy向量化操作，避免低效循环，适合处理大规模问题。研究不仅停留在数学层面，更推动了对生态系统管理的实际思考。但是实际在代码的推进过程中已然遇到了不少问题，不过都能一一解决。



**建议成绩：** 95/ 100分
